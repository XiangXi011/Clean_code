# å¯¼å…¥ mysql.connector ä¹‹å‰å…ˆå°è¯•å¯¼å…¥é…ç½®ï¼Œè¿™æ ·å¯ä»¥å…ˆæ•è·é…ç½®é”™è¯¯
try:
    from config import Config
except ValueError as e:
    print(f"âŒ é…ç½®æ–‡ä»¶é”™è¯¯: {e}")
    print("   è¯·ç«‹å³æ£€æŸ¥æ‚¨çš„ .env æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿æ¯ä¸ªå˜é‡éƒ½ç‹¬å ä¸€è¡Œã€‚")
    exit() # é…ç½®æœ‰è¯¯ï¼Œç›´æ¥é€€å‡º

import mysql.connector
import traceback

# è¿™æ˜¯æ‚¨æ‰€æœ‰å›ºåŒ–ç‚‰çš„â€œä¸»åˆ—è¡¨â€ã€‚
# è¿™ä¸ªè„šæœ¬çš„å”¯ä¸€ç›®çš„ï¼Œå°±æ˜¯å°†è¿™ä¸ªåˆ—è¡¨ä¸€æ¬¡æ€§åœ°å¯¼å…¥åˆ°æ‚¨çš„æ•°æ®åº“ä¸­ã€‚
FURNACES = [
    "A02", "A06", "A07", "A10", "A11", "A12", "A13", "A14", "A15", "A16", "A18", "A21", "A22", "A24", "A25", "A27", "A29",
    "B01", "B02", "B03", "B04", "B05", "B06", "B07", "B08", "B09", "B10", "B11", "B12", "B13", "B14", "B15", "B16", "B17", "B18", "B19", "B20", "B21", "B22", "B23", "B24",
    "C01", "C02", "C03", "C04", "C05", "C06", "C07", "C08", "C09", "C10", "C11", "C12", "C13", "C14", "C15", "C16", "C17", "C18", "C19", "C20", "C21", "C22", "C23", "C24", "C25", "C26", "C27", "C28", "C29", "C30", "C31", "C32", "C33", "C34", "C35", "C36",
    "D01", "D02", "D03", "D04", "D05", "D06", "D07", "D08", "D09", "D10", "D11", "D12", "D13", "D14", "D15", "D16", "D17", "D18", "D19", "D20", "D21", "D22", "D23", "D24", "D25", "D26", "D27", "D28", "D29", "D30", "D31", "D32", "D33", "D34", "D35", "D36", "D37", "D38", "D39", "D40", "D41", "D42", "D43", "D44", "D45", "D46", "D47", "D48", "D49", "D50", "D51", "D52", "D53", "D54", "D55", "D56", "D57", "D58", "D59", "D60", "D61", "D62", "D63", "D64", "D65", "D66", "D67", "D68", "D69", "D70", "D71", "D72", "D73", "D74", "D75", "D76", "D77", "D78", "D79", "D80", "D81", "D82", "D83", "D84", "D85", "D86", "D87", "D88", "D89", "D90", "D91", "D92", "D93", "D94", "D95", "D96", "D97", "D98", "D99"
]

def main():
    """
    ä¸»å‡½æ•°ï¼Œç”¨äºè¿æ¥æ•°æ®åº“å¹¶å¡«å……å›ºåŒ–ç‚‰ä¸»æ•°æ®ã€‚
    è¿™æ˜¯ä¸€ä¸ªã€ä¸€æ¬¡æ€§ã€‘çš„è®¾ç½®è„šæœ¬ï¼Œåªéœ€æˆåŠŸè¿è¡Œä¸€æ¬¡å³å¯ã€‚
    """
    db_conn = None
    try:
        # å»ºç«‹æ•°æ®åº“è¿æ¥
        db_conn = mysql.connector.connect(
            host=Config.DB_HOST,
            user=Config.DB_USER,
            password=Config.DB_PASSWORD,
            database=Config.DB_NAME,
            port=Config.DB_PORT
        )
        cursor = db_conn.cursor()
        print("âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ!")

        # å¡«å……å›ºåŒ–ç‚‰ä¸»æ•°æ®
        print("æ­£åœ¨å¡«å……å›ºåŒ–ç‚‰ä¸»æ•°æ®...")
        insert_furnace_query = "INSERT IGNORE INTO furnaces (name) VALUES (%s)"
        furnace_data = [(name,) for name in FURNACES]
        cursor.executemany(insert_furnace_query, furnace_data)
        db_conn.commit()
        print(f"âœ… å®Œæˆ! {cursor.rowcount} æ¡æ–°çš„å›ºåŒ–ç‚‰æ•°æ®è¢«æ’å…¥ã€‚")
        print("   (å¦‚æœæ•°å­—ä¸º0ï¼Œè¯´æ˜æ‰€æœ‰å›ºåŒ–ç‚‰å·²å­˜åœ¨äºæ•°æ®åº“ä¸­ï¼Œè¿™ä¹Ÿæ˜¯æ­£å¸¸çš„)")
        
        print("\nğŸ‰ æ•°æ®åº“åˆå§‹æ•°æ®å¡«å……å®Œæ¯•ï¼")

    except mysql.connector.Error as err:
        print(f"âŒ æ•°æ®åº“è¿æ¥æˆ–æ“ä½œå¤±è´¥: {err}")
        print("   è¯·ä»”ç»†æ£€æŸ¥æ‚¨çš„ .env æ–‡ä»¶ä¸­çš„æ•°æ®åº“åœ°å€ã€ç”¨æˆ·åã€å¯†ç ã€æ•°æ®åº“åæ˜¯å¦æ­£ç¡®ï¼Œä»¥åŠIPç™½åå•æ˜¯å¦å·²é…ç½®ã€‚")
        traceback.print_exc()
    finally:
        if db_conn and db_conn.is_connected():
            cursor.close()
            db_conn.close()
            print("ğŸ”Œ æ•°æ®åº“è¿æ¥å·²å…³é—­ã€‚")

if __name__ == "__main__":
    main()